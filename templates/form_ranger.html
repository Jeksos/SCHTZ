from flask import Flask, request, jsonify, render_template

app = Flask(__name__)

# Simuler la base de données des emplacements occupés
occupied_emplacements = {
    'A1': '2023-08-01',
    'B2': '2023-07-15',
}

# Route principale qui renvoie le formulaire
@app.route('/')
def index():
    return render_template('ranger_composant.html')

# Route pour vérifier si l'emplacement est libre
@app.route('/check_emplacement', methods=['GET'])
def check_emplacement():
    allee = request.args.get('allee')
    emplacement = request.args.get('emplacement')
    if f'{allee}{emplacement}' in occupied_emplacements:
        return jsonify({'occupied': True})
    return jsonify({'occupied': False})

# Route pour ajouter le composant (si l'emplacement est libre)
@app.route('/ajouter_composant', methods=['POST'])
def ajouter_composant():
    allee = request.form.get('allee')
    emplacement = request.form.get('emplacement')
    reference = request.form.get('reference')
    date = request.form.get('date')

    if f'{allee}{emplacement}' in occupied_emplacements:
        return "Emplacement déjà occupé", 400
    # Ajouter la logique pour insérer dans la base de données
    occupied_emplacements[f'{allee}{emplacement}'] = date
    return "Composant ajouté avec succès"

if __name__ == '__main__':
    app.run(debug=True)









